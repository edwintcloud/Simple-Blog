{% extends "index.njk" %}

{% block body %}
<div class="card">
    <header class="card-header has-background-light">
        <section class="hero">
            <div class="hero-body">
                <div class="container">
                    <h1 class="title" style="margin-bottom:2px;">
                        {{ post.title }}
                    </h1>
                    <nav class="level" style="margin-left:5px;">
                        <div class="level-left">
                            <div class="level-item">
                                <span class="icon is-small is-left">
                                    <i class="fas fa-user-circle" aria-hidden="true"></i>
                                </span>
                                <span style="margin-left: 8px;">by: {{ post.author }} on {{ post.updatedAt | date('MMM D') }} at {{ post.updatedAt | date('LT')}}</span>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </section>
    </header>
    <div class="card-content">
        <div class="content">
            {{ post.content }}
        </div>
    </div>
    <footer class="card-footer" style="flex-direction: column;">
        <div class="card-footer-item is-size-5" style="align-items: start; flex-direction:column; margin-bottom: 20px; margin-top: 10px;">Comments</div>
        <div style="margin-left: 20px; margin-right: 20px; margin-bottom: 20px;">
        {% for comment in comments %}
            <article class="media">
              <figure class="media-left">
                <p class="image is-64x64">
                  <img src="https://bulma.io/images/placeholders/128x128.png">
                </p>
              </figure>
              <div class="media-content">
                <div class="content">
                  <p>
                    <strong>{{ comment.author }}</strong>
                    <br>
                    {{ comment.content }}
                    <br>
                    {% if session.screenName == comment.author %}
                        <small><a>Edit</a> · <a>Delete</a> · {{ comment.updatedAt | date('LLL') }}</small>
                    {% else %}
                        <small> · {{ comment.updatedAt | date('LLL') }}</small>    
                    {% endif %}
                  </p>
                </div>
              </div>
            </article>
        {% endfor %}
<article class="media">
  <figure class="media-left">
    <p class="image is-64x64">
      <img src="https://bulma.io/images/placeholders/128x128.png">
    </p>
  </figure>
  {% if session.screenName %}
      <div class="media-content" id="add-comment">
        <div class="field">
          <p class="control">
              <input type="hidden" name="author" value="{{ session.screenName }}">
              <input type="hidden" name="postId" value="{{ post._id }}">
            <textarea class="textarea" name="content" placeholder="Add a comment..."></textarea>
          </p>
        </div>
        <div class="field">
          <p class="control">
            <button class="button" onclick="addComment()">Post comment</button>
          </p>
        </div>
      </div>
  {% endif %}

</article></div>
    </footer>
</div>
{% endblock %}
